## Experiment 9: Shell Programming Continued – System Performance Monitoring

### Name: Tushita Sharma  Roll No.: 590029121   Date: 2025-09-26

### Aim:

* To continue shell programming practice with scripts for system performance monitoring.
* To use Linux commands (`top`, `htop`, `uptime`, `free`, `vmstat`, `iostat`, `sar`) to monitor CPU, memory, and disk usage.
* To automate performance checks with shell scripts.

### Requirements

* A Linux machine with bash shell.
* Tools: `top`, `htop`, `vmstat`, `iostat`, `sar` (install `sysstat` package for `sar`).

---

## Theory

System performance monitoring ensures efficient use of CPU, memory, and I/O resources. Linux provides commands like:

* `top`/`htop`: real-time CPU, memory, process usage.
* `uptime`: system uptime and load average.
* `free`: RAM and swap usage.
* `vmstat`: process, memory, CPU statistics.
* `iostat`: CPU and disk I/O statistics.
* `sar`: historical system statistics.

Shell scripts can capture these outputs into log files for analysis and troubleshooting.

---

## Procedure & Observations

## Exercise 1: Checking CPU and Memory with `top` and `htop`

### Task Statement:

Run `top` and `htop` to observe CPU and memory usage in real-time.

### Command(s):

```bash
top
htop
```

### Output:
![exp9_top_htop.png](/.img/img2.png)
![exp9_top_htop.png](/.img/img1.png)

## Exercise 2: System Load and Uptime

### Task Statement:

Check system uptime and load averages.

### Command(s):

```bash
uptime
```

### Output:
![exp9_top_htop.png](/.img/img3.png)

## Exercise 3: Memory Usage with `free`

### Task Statement:

Display total, used, and free memory along with swap usage.

### Command(s):

```bash
free -h
```

### Output:

![exp9_top_htop.png](/.img/img4.png)

## Exercise 4: Monitoring with `vmstat`

### Task Statement:

Check system processes, memory, CPU, and I/O statistics.

### Command(s):

```bash
vmstat 5 5
```

### Output:

    

## Exercise 5: Disk I/O Monitoring with `iostat`

### Task Statement:

Monitor CPU utilization and I/O statistics of devices.

### Command(s):

```bash
iostat -xz 5 3
```

### Output:
![exp9_top_htop.png](/.img/img6.png)

## Exercise 6: Historical Monitoring with `sar`

### Task Statement:

Display CPU usage statistics using `sar`.

### Command(s):

```bash
sar -u 5 5
```

### Output:

![exp9_top_htop.png](/.img/img7.png)

## ## Exercise 1:

* [largest file]

## task statement:

* [write the script in shell programming]

## Explanation:

* [Write a script to find the largest file in a given directory.]

## command(s):

```
#!/bin/bash

read -p "Enter directory path: " dir

if [ ! -d "$dir" ]; then echo "Error: Directory '$dir' does not exist." exit 1fi

largest_file=$(find "$dir" -type f -exec du -h {} + | sort -hr | head -n 1)

if [ -z "$largest_file" ]; then echo "No files found in directory '$dir'."else echo " Largest file in '$dir': $largest_file"fi
```

## output:
![exp9_top_htop.png](/.img/img8.png)



# Exercise 2: [count]

## Task statement:

* [count number of .sh files]

## Explanation:

* [Create a script that counts how many .sh files exist in /home/user.]

## command(s):

```
#!/bin/bash

dir="/mnt/c/Users/LENOVO/OneDrive/Documents/linux lab/New folder"

if [ ! -d "$dir" ]; then echo "Error: Directory '$dir' does not exist." exit 1fi

count=$(find "$dir" -maxdepth 1 -type f -name "*.sh" | wc -l)

echo "Number of .sh files in '$dir': $count"
```



## output:
![img](/.img/img9.png)

## Exercise 3: [CPU]

## Task Statement:

* [writing a script]

## Explanation:

* [Write a script to monitor CPU usage every 10 seconds and log to a file.]

## command(s):

```
#!/bin/bash

LOGFILE="cpu_usage.log"


echo "Timestamp,CPU_Usage(%)" > "$LOGFILE"


while true; do

    cpu=$(top -bn1 | grep "Cpu(s)" | \
          awk '{usage=100-$8; printf "%.2f", usage}')  # idle = $8, usage = 100-idle


    timestamp=$(date +"%Y-%m-%d %H:%M:%S")


    echo "$timestamp, $cpu"


    echo "$timestamp,$cpu" >> "$LOGFILE"


    sleep 10
done
```

## output:
![exp9_top_htop.png](/.img/img10.png)

## Exercise 4: [newuser]

## Task Statement:

* [create a script]

## Explanation:

* [Create a script that adds a new user and sets default permissions for their home directory.]

## command(s):

```
#!/bin/bash

read -p "Enter new username: " username

if id "$username" &>/dev/null; then echo "Error: User '$username' already exists." exit 1fi

sudo useradd -m "$username"

sudo chmod 700 "/home/$username"

sudo passwd "$username"

echo " User '$username' created with home directory /home/$username"echo " Permissions set to 700 (owner only)"
```



## output:
![exp9_top_htop.png](/.img/img11.png)


## Result

* Practiced real-time and historical system performance monitoring.
* Automated performance logging with a shell script.

## Challenges Faced & Learning Outcomes

* Challenge 1: `sar` not available by default. Solved by installing `sysstat`.
* Challenge 2: Managing continuous logging. Solved by running script in background and monitoring file size.

### Learning:

* Learned to interpret CPU, memory, and disk usage with various tools.
* Automated monitoring improves system administration efficiency.

## Conclusion

This experiment extended shell programming into **system monitoring** using commands and scripts, building skills for real-world system administration.
